#+TITLE: RFC 7030 Client Requirements Matrix

| Section | Type     | Clause                                                                                   | Status          |
|---------+----------+------------------------------------------------------------------------------------------+-----------------|
|     3.1 | MUST     | be capable of generating and parsing Simple PKI messages                                 | Implemented     |
|     3.1 | MUST     | request CA certificates from the EST server and parse the returned "bag" of certificates | TODO            |
|     3.1 | OPTIONAL | Generating and parsing Full PKI messages                                                 | Not implemented |
|     3.1 | OPTIONAL | Requesting CSR attributes and parsing the returned list                                  | Not implemented |

| Section | Type     | Clause                                                                          | Status      |
|---------+----------+---------------------------------------------------------------------------------+-------------|
|   3.2.3 | MUST     | HTTP Basic and Digest over HTTPS only                                           | Implemented |
|   3.2.3 | MUST     | Terminate if retry is not available                                             | Implemented |
|   3.2.3 | MUST NOT | NULL and anon cipher suites                                                     | Implemented |
|   3.2.1 | SHOULD   | redirections to the same web origin                                             | Implemented |
|   3.2.3 | SHOULD   | Basic and Digest authentication                                                 | TODO        |
|   3.2.3 | MAY      | Set username to empty string                                                    | Implemented |
|   3.2.3 | MUST NOT | respond to the server's HTTP authentication request [...] without authorization | Implenented |

| Section | Type        | Clause                                                                                       | Status          |
|---------+-------------+----------------------------------------------------------------------------------------------+-----------------|
|     3.3 | MUST        | authenticated [server] during the TLS handshake unless                                       | Implemented     |
|     3.3 | MUST        | TLS 1.1 or later                                                                             | Implemented     |
|     3.3 | SHOULD      | TLS session resumption                                                                       | Not implemented |
|   3.3.1 | MUST        | TLS server authentication with certificates                                                  | Implemented     |
|   3.3.1 | MUST        | Certificate validation [...] per RFC 5280                                                    | Implemented     |
|   3.3.1 | MUST        | maintain a distinction between the use of Explicit and Implicit TA databases                 | Implemented     |
|   3.3.1 | MUST        | perform authorization checks as specified in Section 3.6                                     | Implemented     |
|   3.3.1 | MAY         | follow the procedure outlined in Section 4.1.1 for Bootstrap Distribution of CA certificates | TODO            |
|   3.3.2 | RECOMMENDED | TLS client authentication                                                                    | TODO            |
|   3.3.2 | MAY         | HTTP-based client authentication                                                             | Implemented     |
|   3.3.2 | MUST        | [use the certificate] to be renewed or rekeyed [...] for the TLS handshake                   | TODO            |
|   3.3.2 | SHOULD      | use an alternate certificate                                                                 | TODO            |
|   3.3.2 | MAY         | use a client certificate issued by a third party to authenticate itself                      | TODO            |
|   3.3.2 | MUST        | Certificate validation [...] per RFC 5280                                                    | Implemented     |
|   3.3.2 | MUST        | conform to the RFC 5280 profile                                                              | Implemented     |
|   3.3.2 | MUST        | support HTTP-based authentication or certificate-less TLS authentication                     | Implemented     |
|   3.3.3 | MAY         | negotiate a certificate-less cipher suite for mutual authentication                          | Not implemented |

| Section | Type   | Clause                                                                                 | Status          |
|---------+--------+----------------------------------------------------------------------------------------+-----------------|
|     3.5 | SHOULD | link identity and POP by embedding tls-unique information in the certification request | Not implemented |

| Section | Type | Clause                                                                           | Status          |
|---------+------+----------------------------------------------------------------------------------+-----------------|
|     3.6 | MUST | check EST server authorization before [any further protocol action]              | Implemented     |
|     3.6 | MAY  | perform bootstrapping                                                            | Not implemented |
|   3.6.1 | MUST | check either the configured URI or redirection URI against the server's identity | Implemented     |
|   3.6.2 | MUST | check either the configured URI or redirection URI against the server's identity | Implemented     |

| Section | Type   | Clause                                                                            | Status          |
|---------+--------+-----------------------------------------------------------------------------------+-----------------|
|   4.1.1 |        | Bootstrap distribution                                                            | Not implemented |
|   4.1.2 | MUST   | support the /cacerts function                                                     | TODO            |
|   4.1.2 | SHOULD | request an up-to-date response before stored information has expired              | TODO            |
|   4.1.2 | MUST   | authenticate the EST server                                                       | TODO            |
|   4.1.3 | MUST   | be able to handle [root CA key update] in the response.                           | TODO            |
|   4.1.3 | MUST   | validated using normal [RFC5280] certificate path validation                      | Implemented     |
|   4.1.3 | MUST   | store the extracted EST CA certificate as an Explicit TA database entry           | TODO            |
|   4.1.3 | MUST   | make the CA Certificate response information available to the end-entity software | Implemented     |

| Section | Type       | Clause                                                                                      | Status          |
|---------+------------+---------------------------------------------------------------------------------------------+-----------------|
|     4.2 | RECOMMEDED | obtain the current CA certificates [...] before performing certificate request              | TODO            |
|     4.2 | MUST       | authenticate the EST server                                                                 | Implemented     |
|     4.2 | MUST       | verify the authorization of the EST server                                                  | Implemented     |
|   4.2.1 | MUST       | include a Simple PKI Request                                                                | Implemented     |
|   4.2.1 | MUST       | generate the CSR signature using the private key                                            | Implemented     |
|   4.2.1 | MAY        | [if keyUsage without digitalSignature] generate the CSR signature using the private key     | Implemented     |
|   4.2.1 | MUST NOT   | [if keyUsage without digitalSignature] be used for any other signature operations           | Implemented     |
|   4.2.1 | MAY        | include the ChangeSubjectName attribute [for renewal or rekey]                              | Not implemented |
|   4.2.1 | MAY        | request additional certificates                                                             | Not implemented |
|   4.2.2 | MUST       | [Subject field] be identical to the corresponding fields in the certificate                 | Implemented     |
|   4.2.2 | MAY        | [ChangeSubjectName] be included in the CSR to request                                       | Not implemented |
|   4.2.3 | MUST       | wait at least the specified "retry-after" time before [retrying]                            | Implemented     |
|   4.2.3 | SHOULD     | log or inform the end-user of this event                                                    | Implemented     |
|   4.2.3 | MAY        | make the certificate response, and associated private key, available to end-entity software | Implemented     |

| Section | Type     | Clause                            | Status          |
|---------+----------+-----------------------------------+-----------------|
|     4.3 | OPTIONAL | Support for the /fullcmc function | Not implemented |

| Section | Type     | Clause                                 | Status          |
|---------+----------+----------------------------------------+-----------------|
|     4.4 | OPTIONAL | Support for the /serverkeygen function | Not implemented |

| Section | Type   | Clause                                | Status          |
|---------+--------+---------------------------------------+-----------------|
|     4.5 | SHOULD | request a list of expected attributes | Not implemented |
